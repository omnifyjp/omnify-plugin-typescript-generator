{"version":3,"sources":["../src/ai-guides/generator.ts","../src/stubs.ts"],"sourcesContent":["/**\n * AI Guides Generator for TypeScript/Frontend\n *\n * TypeScript/Reactプロジェクト用のAIガイド生成\n * @famgia/omnify-coreの統一ジェネレーターを使用\n */\n\nimport { existsSync, readdirSync } from 'node:fs';\nimport { resolve } from 'node:path';\nimport {\n    generateAIGuides as coreGenerateAIGuides,\n} from '@famgia/omnify-core';\n\n/**\n * Options for AI guides generation\n */\nexport interface AIGuidesOptions {\n    /**\n     * TypeScript output path from config (e.g., 'resources/ts/omnify')\n     * Used to extract the base path for glob replacement\n     */\n    typescriptPath?: string;\n\n    /**\n     * Base path for TypeScript files (default: extracted from typescriptPath or 'src')\n     * Used for placeholder replacement in Cursor rules\n     */\n    typescriptBasePath?: string;\n}\n\n/**\n * Result of AI guides generation\n */\nexport interface AIGuidesResult {\n    claudeGuides: number;\n    claudeChecklists: number;\n    cursorRules: number;\n    files: string[];\n}\n\n/**\n * Extract TypeScript base path from typescriptPath\n * e.g., 'resources/ts/omnify' -> 'resources/ts'\n * e.g., 'src/generated' -> 'src'\n */\nfunction extractTypescriptBasePath(typescriptPath?: string): string {\n    if (!typescriptPath) return 'src';\n\n    const normalized = typescriptPath.replace(/\\\\/g, '/');\n\n    // Remove last segment (omnify, generated, etc.)\n    const parts = normalized.split('/').filter(Boolean);\n    if (parts.length > 1) {\n        return parts.slice(0, -1).join('/');\n    }\n\n    return 'src';\n}\n\n/**\n * Generate AI guides for Claude and Cursor\n */\nexport function generateAIGuides(\n    rootDir: string,\n    options: AIGuidesOptions = {}\n): AIGuidesResult {\n    const basePath = options.typescriptBasePath || extractTypescriptBasePath(options.typescriptPath);\n\n    // Coreジェネレーターを呼び出し\n    const coreResult = coreGenerateAIGuides(rootDir, {\n        placeholders: {\n            TYPESCRIPT_BASE: basePath,\n            LARAVEL_BASE: 'app',\n            LARAVEL_ROOT: '',\n        },\n        // TypeScriptプロジェクトではReact関連のみ\n        adapters: ['cursor', 'claude'],\n    });\n\n    // 結果を変換 (後方互換性のため)\n    const result: AIGuidesResult = {\n        claudeGuides: 0,\n        claudeChecklists: 0,\n        cursorRules: 0,\n        files: coreResult.files,\n    };\n\n    // ファイル数をカウント\n    const claudeCount = coreResult.counts['claude'] || 0;\n    const cursorCount = coreResult.counts['cursor'] || 0;\n\n    result.claudeGuides = Math.floor(claudeCount * 0.8);\n    result.claudeChecklists = claudeCount - result.claudeGuides;\n    result.cursorRules = cursorCount;\n\n    return result;\n}\n\n/**\n * Check if AI guides need to be generated\n */\nexport function shouldGenerateAIGuides(rootDir: string): boolean {\n    const claudeDir = resolve(rootDir, '.claude/omnify/guides/react');\n    const cursorDir = resolve(rootDir, '.cursor/rules/omnify');\n\n    if (!existsSync(claudeDir) || !existsSync(cursorDir)) {\n        return true;\n    }\n\n    try {\n        const claudeFiles = readdirSync(claudeDir);\n        const cursorFiles = readdirSync(cursorDir);\n\n        return claudeFiles.length === 0 || cursorFiles.length === 0;\n    } catch {\n        return true;\n    }\n}\n","/**\n * Stubs management for TypeScript generator\n *\n * Currently a placeholder - React utility stubs feature is not yet implemented.\n */\n\nexport interface CopyStubsOptions {\n    targetDir: string;\n    skipIfExists?: boolean;\n}\n\nexport interface CopyStubsResult {\n    copied: string[];\n    skipped: string[];\n}\n\n/**\n * Copy React utility stubs to target directory.\n *\n * Currently returns empty result as React utility stubs feature\n * is not yet implemented. The AI guides are handled separately\n * via generateAIGuides().\n */\nexport function copyStubs(_options: CopyStubsOptions): CopyStubsResult {\n    // React utility stubs feature not yet implemented\n    // AI guides are handled via generateAIGuides()\n    return {\n        copied: [],\n        skipped: [],\n    };\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOA,SAAS,YAAY,mBAAmB;AACxC,SAAS,eAAe;AACxB;AAAA,EACI,oBAAoB;AAAA,OACjB;AAkCP,SAAS,0BAA0B,gBAAiC;AAChE,MAAI,CAAC,eAAgB,QAAO;AAE5B,QAAM,aAAa,eAAe,QAAQ,OAAO,GAAG;AAGpD,QAAM,QAAQ,WAAW,MAAM,GAAG,EAAE,OAAO,OAAO;AAClD,MAAI,MAAM,SAAS,GAAG;AAClB,WAAO,MAAM,MAAM,GAAG,EAAE,EAAE,KAAK,GAAG;AAAA,EACtC;AAEA,SAAO;AACX;AAKO,SAAS,iBACZ,SACA,UAA2B,CAAC,GACd;AACd,QAAM,WAAW,QAAQ,sBAAsB,0BAA0B,QAAQ,cAAc;AAG/F,QAAM,aAAa,qBAAqB,SAAS;AAAA,IAC7C,cAAc;AAAA,MACV,iBAAiB;AAAA,MACjB,cAAc;AAAA,MACd,cAAc;AAAA,IAClB;AAAA;AAAA,IAEA,UAAU,CAAC,UAAU,QAAQ;AAAA,EACjC,CAAC;AAGD,QAAM,SAAyB;AAAA,IAC3B,cAAc;AAAA,IACd,kBAAkB;AAAA,IAClB,aAAa;AAAA,IACb,OAAO,WAAW;AAAA,EACtB;AAGA,QAAM,cAAc,WAAW,OAAO,QAAQ,KAAK;AACnD,QAAM,cAAc,WAAW,OAAO,QAAQ,KAAK;AAEnD,SAAO,eAAe,KAAK,MAAM,cAAc,GAAG;AAClD,SAAO,mBAAmB,cAAc,OAAO;AAC/C,SAAO,cAAc;AAErB,SAAO;AACX;AAKO,SAAS,uBAAuB,SAA0B;AAC7D,QAAM,YAAY,QAAQ,SAAS,6BAA6B;AAChE,QAAM,YAAY,QAAQ,SAAS,sBAAsB;AAEzD,MAAI,CAAC,WAAW,SAAS,KAAK,CAAC,WAAW,SAAS,GAAG;AAClD,WAAO;AAAA,EACX;AAEA,MAAI;AACA,UAAM,cAAc,YAAY,SAAS;AACzC,UAAM,cAAc,YAAY,SAAS;AAEzC,WAAO,YAAY,WAAW,KAAK,YAAY,WAAW;AAAA,EAC9D,QAAQ;AACJ,WAAO;AAAA,EACX;AACJ;;;AC9FO,SAAS,UAAU,UAA6C;AAGnE,SAAO;AAAA,IACH,QAAQ,CAAC;AAAA,IACT,SAAS,CAAC;AAAA,EACd;AACJ;","names":[]}